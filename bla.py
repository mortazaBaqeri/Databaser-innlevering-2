def extract_dates(data):
    date_time_set = set()  # Using a set for fast lookup

    # Split data into lines
    lines = data.splitlines()

    # Skip the first 6 lines
    for line in lines[6:]:
        parts = line.split(',')
        if len(parts) >= 7:  # Ensure the line has enough columns
            date = parts[5]  # Date is in the 6th column
            time = parts[6]  # Time is in the 7th column
            date_time_set.add((date, time))  # Add (date, time) tuple to the set

    return date_time_set


def check_date_exists(date_set, query_date):
    """
    Checks if a given date exists in the set of dates.
    
    Args:
    - date_set (set): A set of dates.
    - query_date (str): The date to check (format: YYYY-MM-DD).
    
    Returns:
    - bool: True if the date exists, False otherwise.
    """
    return query_date in date_set

# Example usage
data = """Geolife trajectory
WGS 84
Altitude is in Feet
Reserved 3
0,2,255,My Track,0,0,2,8421376
0
39.921712,116.472343,0,13,39298.1462037037,2007-08-04,03:30:32
39.921705,116.472343,0,13,39298.1462152778,2007-08-04,03:30:33
39.921695,116.472345,0,13,39298.1462268519,2007-08-04,03:30:34
39.921683,116.472342,0,13,39298.1462384259,2007-08-04,03:30:35
39.921672,116.472342,0,13,39298.14625,2007-08-04,03:30:36
39.921583,116.472315,0,13,39298.1462731481,2007-08-04,03:30:38
39.921572,116.472315,0,13,39298.1462847222,2007-08-04,03:30:39
39.92156,116.47229,0,13,39298.1462962963,2007-08-04,03:30:40
39.921565,116.47229,0,13,39298.1463078704,2007-08-04,03:30:41
39.92157,116.472288,0,13,39298.1463194444,2007-08-04,03:30:42
39.921577,116.4723,0,13,39298.1463310185,2007-08-04,03:30:43
39.92158,116.472307,0,13,39298.1463425926,2007-08-04,03:30:44
39.921562,116.472303,0,13,39298.1463541667,2007-08-04,03:30:45
39.921545,116.472308,0,13,39298.1463657407,2007-08-04,03:30:46
39.921532,116.472313,0,13,39298.1463773148,2007-08-04,03:30:47
39.921505,116.472317,0,13,39298.146400463,2007-08-04,03:30:49
39.921492,116.472317,0,13,39298.146412037,2007-08-04,03:30:50
39.921485,116.472323,0,13,39298.1464351852,2007-08-04,03:30:52
39.921487,116.472323,0,13,39298.1464930556,2007-08-04,03:30:57
39.921487,116.472318,0,13,39298.1465046296,2007-08-04,03:30:58
39.921483,116.472312,0,13,39298.1465162037,2007-08-04,03:30:59
39.921463,116.472305,0,13,39298.1465393519,2007-08-04,03:31:01
39.92145,116.472302,0,13,39298.1465509259,2007-08-04,03:31:02
39.921428,116.472323,0,15,39298.1465625,2007-08-04,03:31:03
39.921423,116.47232,0,20,39298.1465740741,2007-08-04,03:31:04
39.921415,116.47232,0,20,39298.1465856481,2007-08-04,03:31:05
39.921403,116.472338,0,3,39298.1465972222,2007-08-04,03:31:06
39.921395,116.472348,0,0,39298.1466087963,2007-08-04,03:31:07"""

# Extract dates from the data
date_set = extract_dates(data)
print(date_set)

# Check if a specific date exists
query_date = "2007-08-04"
print(check_date_exists(date_set, query_date))  # Output: True or False
